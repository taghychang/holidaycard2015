function processHandler(e,a){return!0}function scoreHandler(e){0===e.frame||1===e.frame?(score+=1,console.log(score)):(score-=1,console.log("--"+score)),stageFreeze.frame=score,checkEnd(),adjustDifficulty(),console.log("time on table(speed) ="+cup_speed)}function collisionHandler(e,a){0===a.frame||1===a.frame?(a.kill(),console.log("hot")):(a.kill(),console.log("ice")),scoreHandler(a)}function moveOver(){var e=game.width/2;game.input.worldX<=e?movePlayer.left():game.input.worldX>=e&&movePlayer.right()}function beginSwipe(){var e;e=game.input.worldX,game.input.onDown.remove(beginSwipe),game.input.onUp.add(endSwipe)}function endSwipe(){endX=game.input.worldX;var e=startX-endX;Math.abs(e)>10&&(e>0?movePlayer.left():movePlayer.right()),game.input.onDown.add(beginSwipe),game.input.onUp.remove(endSwipe)}function checkPos(e){e.y>3*game.height&&(e.y=-1e3)}function adjustDifficulty(){cup_speed=2300-250*score}function checkEnd(){10==score?(console.log("YOU WIN"),game.state.start("EndGame")):0==score&&(console.log("YOU LOSE"),game.state.start("EndGame"))}function ServeCup(){function e(){tween_position=game.add.tween(n),tween_position.to({y:1200},1e3,"Linear",!0,0),tween_position.start()}var a=395,o=782,n;"left"===this.lane?n=cups_on_table.create(game.rnd.between(240,265),a,"cup_move"):"mid"===this.lane?n=cups_on_table.create(game.rnd.between(295,280),a,"cup_move"):"right"===this.lane&&(n=cups_on_table.create(game.rnd.between(345,370),a,"cup_move")),n.frame=game.rnd.between(0,3),n.scale.setTo(.17,.17),n.anchor.set(.5,.9),tween_size=game.add.tween(n.scale),tween_size.to({x:.5,y:.5},cup_speed,"Linear",!0,0),tween_position=game.add.tween(n),"left"===this.lane?tween_position.to({x:game.rnd.between(0,108),y:o},cup_speed,"Linear",!0,0):"mid"===this.lane?tween_position.to({x:game.rnd.between(240,360),y:o},cup_speed,"Linear",!0,0):"right"===this.lane&&tween_position.to({x:game.rnd.between(472,580),y:o},cup_speed,"Linear",!0,0),tween_position.onComplete.addOnce(e),tween_position.start(),cups_on_table.sort("y",Phaser.Group.SORT_ASCENDING)}var player,playerPosition,playerPositions,playerSpeed=300,cursor,shop,endX,startX,tweenL,tweenR,tween_position,tween_size,cups_on_table,cup_speed,stageFreeze,score,playGame=function(e){},movePlayer={left:function(){playerPosition>0?(tweenL=game.add.tween(player).to({x:playerPositions[playerPosition-1]},playerSpeed,Phaser.Easing.Linear.None,!0),player.animations.play("left",!1),playerPosition--,console.log("lane: "+playerPosition)):player.animations.play("halfLeft",!1)},right:function(){2>playerPosition?(tweenR=game.add.tween(player).to({x:playerPositions[playerPosition+1]},playerSpeed,Phaser.Easing.Linear.None,!0),player.animations.play("right",!1),playerPosition++,console.log("lane: "+playerPosition)):player.animations.play("halfRight",!1)}};playGame.prototype={preload:function(){game.load.image("shop","images/shop.jpg"),game.load.image("table","images/table.png"),game.load.atlas("cup_move","images/cups/cups.png","images/cups/cups.json"),game.load.spritesheet("player","images/playerSprite.png",325,347),game.load.atlas("stageFreeze","images/stageFreeze/stageFreeze.png","images/stageFreeze/stageFreeze.json")},create:function(){game.physics.startSystem(Phaser.Physics.ARCADE),game.add.plugin(Phaser.Plugin.Debug),shop=game.add.sprite(0,0,"shop"),shop.anchor.set(0),score=5,stageFreeze=game.add.sprite(0,0,"stageFreeze"),stageFreeze.frame=score;var e=game.width/2-260,a=game.width/2,o=game.width/2+260,n=[e,a,o];playerPosition=1,playerPositions=[n[0],n[1],n[2]],player=game.add.sprite(playerPositions[playerPosition],game.height-160,"player"),player.anchor.set(.5),game.physics.arcade.enable(player),player.animations.add("left",[0,1,2,3,4],10,!1),player.animations.add("right",[5,6,7,8,4],10,!1),player.animations.add("halfLeft",[0,4],10,!1),player.animations.add("halfRight",[5,4],10,!1),cursor=game.input.keyboard.createCursorKeys(),game.input.onDown.add(moveOver),game.input.onDown.add(beginSwipe,this),cursor.left.onDown.add(movePlayer.left),cursor.right.onDown.add(movePlayer.right),cups_on_table=game.add.physicsGroup(),player.body.setSize(200,100,0,110),game.physics.enable([player,cups_on_table],Phaser.Physics.ARCADE),cursor.left.onDown.add(ServeCup,{lane:"left"}),cursor.right.onDown.add(ServeCup,{lane:"right"}),cursor.down.onDown.add(ServeCup,{lane:"mid"});var t=game.add.group(),r=game.add.group();t.add(player),r.add(stageFreeze),game.world.bringToTop(r)},update:function(){game.physics.arcade.overlap(player,cups_on_table,collisionHandler,processHandler,this)},render:function(){game.debug.body(player),game.debug.body(cups_on_table)}};